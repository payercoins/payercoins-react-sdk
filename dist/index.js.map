{"version":3,"file":"index.js","sources":["../src/script.ts","../src/actions/payercoins-actions.ts","../src/usePayercoins.ts"],"sourcesContent":["import { useState, useEffect } from 'react'\r\n\r\nconst cachedScripts: string[] = []\r\ninterface IScriptResult {\r\n  loaded: boolean\r\n  error: boolean\r\n}\r\n\r\nexport default function usePayercoinsScript(): boolean[] {\r\n  const src =\r\n    'https://checkout.payercoins.com/index.min.js'\r\n\r\n  const [state, setState] = useState<IScriptResult>({\r\n    loaded: false,\r\n    error: false\r\n  })\r\n\r\n  useEffect((): any => {\r\n    if (cachedScripts.includes(src)) {\r\n      // If script is already loaded, don't load again\r\n      // set loaded to true\r\n      setState({\r\n        loaded: true,\r\n        error: false\r\n      })\r\n    } else {\r\n      cachedScripts.push(src)\r\n\r\n      const script = document.createElement('script')\r\n      script.src = src\r\n      script.async = true\r\n\r\n      const onScriptLoad = (): void => {\r\n        setState({\r\n          loaded: true,\r\n          error: false\r\n        })\r\n      }\r\n\r\n      const onScriptError = (): void => {\r\n        const index = cachedScripts.indexOf(src)\r\n        if (index >= 0) cachedScripts.splice(index, 1)\r\n        script.remove()\r\n\r\n        setState({\r\n          loaded: true,\r\n          error: true\r\n        })\r\n      }\r\n\r\n      script.addEventListener('load', onScriptLoad)\r\n      script.addEventListener('complete', onScriptLoad)\r\n      script.addEventListener('error', onScriptError)\r\n\r\n      document.body.appendChild(script)\r\n\r\n      return (): void => {\r\n        script.removeEventListener('load', onScriptLoad)\r\n        script.removeEventListener('error', onScriptError)\r\n      }\r\n    }\r\n  }, [src])\r\n\r\n  return [state.loaded, state.error]\r\n}","export const callPayercoinsPop = (PayercoinsArgs: any): void => {\r\n  // @ts-ignore\r\n  return (\r\n    // @ts-ignore\r\n    window.Payercoins &&\r\n    // @ts-ignore\r\n    window.Payercoins({\r\n      key: PayercoinsArgs.key,\r\n      currency: PayercoinsArgs.currency,\r\n      amount: PayercoinsArgs.amount,\r\n      customer_name: PayercoinsArgs['customer_name'],\r\n      customer_email: PayercoinsArgs['customer_email'],\r\n      description: PayercoinsArgs['description'],\r\n      redirect_url: PayercoinsArgs.redirect_url || \"\",\r\n      callback_url: PayercoinsArgs[\"callback_url\"] || \"\",\r\n    })\r\n  )\r\n}","/* eslint-disable no-unused-vars */\r\nimport { useEffect } from 'react'\r\nimport { PaymentProps } from './@types/index'\r\nimport useScript from './script'\r\nimport { callPayercoinsPop } from './actions/payercoins-actions'\r\n\r\nexport default function usePayercoinsPayment(options: PaymentProps) {\r\n  const [scriptLoaded, scriptError] = useScript()\r\n  const {\r\n    key,\r\n    currency,\r\n    amount,\r\n    customer_name,\r\n    customer_email,\r\n    description,\r\n    redirect_url,\r\n    callback_url\r\n  } = options\r\n\r\n  function initializePayment(): void {\r\n    if (scriptError) {\r\n      throw new Error('Unable to load Lazerpay inline script')\r\n    }\r\n\r\n    if (scriptLoaded) {\r\n      const PayercoinsArgs = {\r\n        key,\r\n        currency,\r\n        amount,\r\n        customer_name,\r\n        customer_email,\r\n        description,\r\n        redirect_url,\r\n        callback_url\r\n      }\r\n      callPayercoinsPop(PayercoinsArgs)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (scriptError) {\r\n      throw new Error('Unable to load payercoins inline script')\r\n    }\r\n  }, [scriptError])\r\n\r\n  return initializePayment\r\n}"],"names":["cachedScripts","usePayercoinsScript","src","useState","loaded","error","state","setState","useEffect","includes","push","script","document","createElement","async","onScriptLoad","onScriptError","index","indexOf","splice","remove","addEventListener","body","appendChild","removeEventListener","callPayercoinsPop","PayercoinsArgs","window","Payercoins","key","currency","amount","customer_name","customer_email","description","redirect_url","callback_url","usePayercoinsPayment","options","useScript","scriptLoaded","scriptError","initializePayment","Error"],"mappings":";;AAEA,IAAMA,aAAa,GAAa,EAAhC;SAMwBC;EACtB,IAAMC,GAAG,GACP,8CADF;;EAGA,gBAA0BC,cAAQ,CAAgB;IAChDC,MAAM,EAAE,KADwC;IAEhDC,KAAK,EAAE;GAFyB,CAAlC;MAAOC,KAAP;MAAcC,QAAd;;EAKAC,eAAS,CAAC;IACR,IAAIR,aAAa,CAACS,QAAd,CAAuBP,GAAvB,CAAJ,EAAiC;MAG/BK,QAAQ,CAAC;QACPH,MAAM,EAAE,IADD;QAEPC,KAAK,EAAE;OAFD,CAAR;KAHF,MAOO;MACLL,aAAa,CAACU,IAAd,CAAmBR,GAAnB;MAEA,IAAMS,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;MACAF,MAAM,CAACT,GAAP,GAAaA,GAAb;MACAS,MAAM,CAACG,KAAP,GAAe,IAAf;;MAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe;QACnBR,QAAQ,CAAC;UACPH,MAAM,EAAE,IADD;UAEPC,KAAK,EAAE;SAFD,CAAR;OADF;;MAOA,IAAMW,aAAa,GAAG,SAAhBA,aAAgB;QACpB,IAAMC,KAAK,GAAGjB,aAAa,CAACkB,OAAd,CAAsBhB,GAAtB,CAAd;QACA,IAAIe,KAAK,IAAI,CAAb,EAAgBjB,aAAa,CAACmB,MAAd,CAAqBF,KAArB,EAA4B,CAA5B;QAChBN,MAAM,CAACS,MAAP;QAEAb,QAAQ,CAAC;UACPH,MAAM,EAAE,IADD;UAEPC,KAAK,EAAE;SAFD,CAAR;OALF;;MAWAM,MAAM,CAACU,gBAAP,CAAwB,MAAxB,EAAgCN,YAAhC;MACAJ,MAAM,CAACU,gBAAP,CAAwB,UAAxB,EAAoCN,YAApC;MACAJ,MAAM,CAACU,gBAAP,CAAwB,OAAxB,EAAiCL,aAAjC;MAEAJ,QAAQ,CAACU,IAAT,CAAcC,WAAd,CAA0BZ,MAA1B;MAEA,OAAO;QACLA,MAAM,CAACa,mBAAP,CAA2B,MAA3B,EAAmCT,YAAnC;QACAJ,MAAM,CAACa,mBAAP,CAA2B,OAA3B,EAAoCR,aAApC;OAFF;;GAvCK,EA4CN,CAACd,GAAD,CA5CM,CAAT;EA8CA,OAAO,CAACI,KAAK,CAACF,MAAP,EAAeE,KAAK,CAACD,KAArB,CAAP;AACD;;AChEM,IAAMoB,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,cAAD;EAE/B,OAEEC,MAAM,CAACC,UAAP,IAEAD,MAAM,CAACC,UAAP,CAAkB;IAChBC,GAAG,EAAEH,cAAc,CAACG,GADJ;IAEhBC,QAAQ,EAAEJ,cAAc,CAACI,QAFT;IAGhBC,MAAM,EAAEL,cAAc,CAACK,MAHP;IAIhBC,aAAa,EAAEN,cAAc,CAAC,eAAD,CAJb;IAKhBO,cAAc,EAAEP,cAAc,CAAC,gBAAD,CALd;IAMhBQ,WAAW,EAAER,cAAc,CAAC,aAAD,CANX;IAOhBS,YAAY,EAAET,cAAc,CAACS,YAAf,IAA+B,EAP7B;IAQhBC,YAAY,EAAEV,cAAc,CAAC,cAAD,CAAd,IAAkC;GARlD,CAJF;AAeD,CAjBM;;SCMiBW,qBAAqBC;EAC3C,iBAAoCC,mBAAS,EAA7C;MAAOC,YAAP;MAAqBC,WAArB;;EACA,IACEZ,GADF,GASIS,OATJ,CACET,GADF;MAEEC,QAFF,GASIQ,OATJ,CAEER,QAFF;MAGEC,MAHF,GASIO,OATJ,CAGEP,MAHF;MAIEC,aAJF,GASIM,OATJ,CAIEN,aAJF;MAKEC,cALF,GASIK,OATJ,CAKEL,cALF;MAMEC,WANF,GASII,OATJ,CAMEJ,WANF;MAOEC,YAPF,GASIG,OATJ,CAOEH,YAPF;MAQEC,YARF,GASIE,OATJ,CAQEF,YARF;;EAWA,SAASM,iBAAT;IACE,IAAID,WAAJ,EAAiB;MACf,MAAM,IAAIE,KAAJ,CAAU,uCAAV,CAAN;;;IAGF,IAAIH,YAAJ,EAAkB;MAChB,IAAMd,cAAc,GAAG;QACrBG,GAAG,EAAHA,GADqB;QAErBC,QAAQ,EAARA,QAFqB;QAGrBC,MAAM,EAANA,MAHqB;QAIrBC,aAAa,EAAbA,aAJqB;QAKrBC,cAAc,EAAdA,cALqB;QAMrBC,WAAW,EAAXA,WANqB;QAOrBC,YAAY,EAAZA,YAPqB;QAQrBC,YAAY,EAAZA;OARF;MAUAX,iBAAiB,CAACC,cAAD,CAAjB;;;;EAIJlB,eAAS,CAAC;IACR,IAAIiC,WAAJ,EAAiB;MACf,MAAM,IAAIE,KAAJ,CAAU,yCAAV,CAAN;;GAFK,EAIN,CAACF,WAAD,CAJM,CAAT;EAMA,OAAOC,iBAAP;AACD;;;;"}