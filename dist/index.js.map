{"version":3,"file":"index.js","sources":["../src/script.ts","../src/actions/payercoins-actions.ts","../src/usePayercoins.ts"],"sourcesContent":["import { useState, useEffect } from 'react'\r\n\r\nconst cachedScripts: string[] = []\r\ninterface IScriptResult {\r\n  loaded: boolean\r\n  error: boolean\r\n}\r\n\r\nexport default function usePayercoinsScript(): boolean[] {\r\n  const src =\r\n    'https://checkout.payercoins.com/index.min.js'\r\n\r\n  const [state, setState] = useState<IScriptResult>({\r\n    loaded: false,\r\n    error: false\r\n  })\r\n\r\n  useEffect((): any => {\r\n    if (cachedScripts.includes(src)) {\r\n      // If script is already loaded, don't load again\r\n      // set loaded to true\r\n      setState({\r\n        loaded: true,\r\n        error: false\r\n      })\r\n    } else {\r\n      cachedScripts.push(src)\r\n\r\n      const script = document.createElement('script')\r\n      script.src = src\r\n      script.async = true\r\n\r\n      const onScriptLoad = (): void => {\r\n        setState({\r\n          loaded: true,\r\n          error: false\r\n        })\r\n      }\r\n\r\n      const onScriptError = (): void => {\r\n        const index = cachedScripts.indexOf(src)\r\n        if (index >= 0) cachedScripts.splice(index, 1)\r\n        script.remove()\r\n\r\n        setState({\r\n          loaded: true,\r\n          error: true\r\n        })\r\n      }\r\n\r\n      script.addEventListener('load', onScriptLoad)\r\n      script.addEventListener('complete', onScriptLoad)\r\n      script.addEventListener('error', onScriptError)\r\n\r\n      document.body.appendChild(script)\r\n\r\n      return (): void => {\r\n        script.removeEventListener('load', onScriptLoad)\r\n        script.removeEventListener('error', onScriptError)\r\n      }\r\n    }\r\n  }, [src])\r\n\r\n  return [state.loaded, state.error]\r\n}","export const callPayercoinsPop = async (PayercoinsArgs: any) => {\r\n\r\n  const payercoins = new window.Payercoins({\r\n    key: PayercoinsArgs.key,\r\n    currency: PayercoinsArgs.currency,\r\n    amount: PayercoinsArgs.amount,\r\n    customer_name: PayercoinsArgs['customer_name'],\r\n    customer_email: PayercoinsArgs['customer_email'],\r\n    description: PayercoinsArgs['description'],\r\n    redirect_url: PayercoinsArgs.redirect_url || \"\",\r\n    callback_url: PayercoinsArgs[\"callback_url\"] || \"\",\r\n  })\r\n\r\n  const data = await payercoins.checkout();\r\n  window.location = data.payment_url;\r\n  return data\r\n  // return payment_url\r\n}","/* eslint-disable no-unused-vars */\r\nimport { useEffect } from 'react'\r\nimport { CheckoutProps } from './@types/index'\r\nimport useScript from './script'\r\nimport { callPayercoinsPop } from './actions/payercoins-actions'\r\n\r\n\r\nexport default function usePayercoinsPayment() {\r\n  const [scriptLoaded, scriptError] = useScript()\r\n\r\n  function initializePayment(options: CheckoutProps) {\r\n    if (scriptError) {\r\n      throw new Error('Unable to load Payercoins inline script')\r\n    }\r\n\r\n    if (scriptLoaded) {\r\n      const {\r\n        key,\r\n        currency,\r\n        amount,\r\n        customer_name,\r\n        customer_email,\r\n        description,\r\n        redirect_url,\r\n        callback_url\r\n      } = options\r\n\r\n      callPayercoinsPop({\r\n        key,\r\n        currency,\r\n        amount,\r\n        customer_name,\r\n        customer_email,\r\n        description,\r\n        redirect_url,\r\n        callback_url\r\n      })\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (scriptError) {\r\n      throw new Error('Unable to load payercoins inline script')\r\n    }\r\n  }, [scriptError])\r\n\r\n  return [initializePayment] as const\r\n}"],"names":["cachedScripts","usePayercoinsScript","src","useState","loaded","error","state","setState","useEffect","includes","push","script","document","createElement","async","onScriptLoad","onScriptError","index","indexOf","splice","remove","addEventListener","body","appendChild","removeEventListener","callPayercoinsPop","PayercoinsArgs","payercoins","window","Payercoins","key","currency","amount","customer_name","customer_email","description","redirect_url","callback_url","checkout","data","location","payment_url","usePayercoinsPayment","useScript","scriptLoaded","scriptError","initializePayment","options","Error"],"mappings":"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"}